# ShachikuVCS for WinSCP

![shckvcs](https://user-images.githubusercontent.com/4313248/159166505-7e2078ec-8214-4eed-a73f-a51f9e59fa50.jpg)

------
# 概要

社畜VCS（Version Control System）はファイルの変更履歴の保存・管理を行う簡易版バージョン管理ツールです。  
Git、SVNといった有名なバージョン管理ツールに比べるとはるかに機能が限定されますが、社畜VCSは  
**定番FTPクライアントソフト`WinSCP`のエクステンション**として機能しワンタッチインストールで  
すぐ使えることが可能であり、WinSCPを介して通信を行うためセキュアで安全にファイルを扱うことができます。  
また直観的なUIで間違ってクローズドソースをネットに公開してしまったなどの誤操作も未然に防ぐことが可能です。  
  
開発ツールが十分に準備されていない、または~~上司に圧力を掛けられて~~ 予算を十分に人件費にさけない  
炎上プロジェクトやスケジュールが超短期でとにかく人手も時間も少なく止むなく~~こんな糞ツール~~に  
頼らざるを得ない。。。などといったありとあらゆる~~過酷な現場~~ 開発シーンにおいては効果が期待できます。
（注：上記プロジェクトの話は全てフィクションであり実際の会社とは一切関係ありません。）

# 動作環境

社畜VCSを動作するにはWindowsがインストールされたパソコンで  
以下のソフトがインストールされているか確認してください。  
  
|フリーソフト名|バージョン|
----|----  
|PowerShell|5.1以上|
|WinSCP|5.19以上|
|WinMerge|2.16以上|
  
  
------

## ワンタッチインストール

1. WinSCPを起動し、リモートサーバーに接続します。  

2. `リモートディレクトリ`のペインを右クリックで  
`静的カスタムコマンド`⇒`カスタマイズ`をクリックします。  
  
![shckvcs_setup1](https://user-images.githubusercontent.com/4313248/161044960-9ec4b16a-6823-42fc-b924-71b65b6eccb7.jpg)
  
3. `追加(A)`右側のプルダウンをクリックして`拡張機能の追加(E)`をクリックします。  
  
![shckvcs_setup4](https://user-images.githubusercontent.com/4313248/161051169-91f316a4-523b-4c03-b1ae-47bde7008af9.jpg)
  
4. `拡張機能の追加`画面のURLにコピーしたGitHubの[Rawリンク](https://github.com/marunowork/ShachikuVCS/raw/main/ShckVCS.WinSCPextension.ps1) を貼り付けします  
  
![shckvcs_setup5](https://user-images.githubusercontent.com/4313248/161051522-a3fce711-1150-4cc1-9a06-4eef0fbbe270.jpg)
  
5. `OK`をクリックします。  
（※以下のような警告メッセージが表示されますが特に問題はありませんので`OK`をクリックして進めます。）  
  
![shckvcs_setup2](https://user-images.githubusercontent.com/4313248/161046076-4ef73f38-84a7-4739-b95e-934e3f928b0b.jpg)


6. 環境設定ウィンドウに戻って、3.のカスタムコマンド一覧に`VCS MENU`が表示されることを確認してください。  

7. これでインストールは完了です  
（※なお初回起動時は`初期設定が完了しました`とメッセージ表示されるだけですが  
ホームディレクトリに専用フォルダと設定ファイルが作成され、起動準備が完了します。）
  
  
------

## アンインストール

Windowsのホームディレクトリ（例：C:￥Users¥(ユーザ名）に作成された  
**ShckConfig.xml**　と　**.shchk**　フォルダを削除すればアンインストール完了です。
  
  
------
  
## 使い方

### 社畜VCSメニュー画面の表示

1. WinSCPを起動し、リモートサーバーに接続します。  

2. リモートディレクトリのペインから管理対象のソースを選択し、  
右クリックで　`ファイルカスタムコマンド`　⇒　`VCS MENU`をクリックします。

3. 社畜VCSメニュー画面が表示されます。  
（※初回起動時に「初期設定が完了しました」とメッセージ表示された場合は再度メニューからクリックしてください。）  
  
  
### 社畜VCS機能の紹介

#### 画面イメージ
![shckvcs_setup3](https://user-images.githubusercontent.com/4313248/161047796-4e27e507-9eb5-45b8-b11e-c7b3f31a7592.jpg)
  
#### 操作ボタンの説明
1. 選択したソースをコミットする場合はコメントを入力して`コミット`をクリックします。  
履歴一覧に入力コメントが追加されます。  
2. リモートファイルとリポジトリを比較する場合は履歴一覧から選択して`リモートファイルと比較`を  
クリックします。
3. 直近リポジトリとの差分を確認したい場合は履歴一覧から選択して`前回リビジョンとの差分を表示`を  
クリックします。
4. リポジトリをリモートに戻す場合は履歴一覧から選択して`リバート`をクリックします。  
（**注意！**）  
リモートファイルが書き換わって戻せなくなるので  
必ず~~鬼~~上司に承認をとってから操作を行ってください。
5. リポジトリをバックアップしたい場合は履歴一覧から選択して`エクスポート`をクリックして  
保存先を選択してください。 
6. コメントを修正したい場合は履歴一覧から選択して`コメント編集`をクリックして編集後  
`コメント更新`をクリックします。
7. 履歴一覧内容を絞り込みたい場合は画面上部テキストボックスに文字列を入力して  
`検索`をクリックします。
8. 上記検索条件をクリアする場合は`クリア`をクリックします。
9. 画面を閉じる場合は`閉じる`をクリックします。
  
  
------
  
### 設定ファイル(ShckConfig.xml)の説明
  
インストール時に自動作成されたShckConfig.xmlの設定を変更することで  
画面項目をカスタマイズすることが可能です。  

**※** 複数でリポジトリを管理共有したい場合は、`history`　`work_dir`　の保存先を  
共有フォルダのパスに変更してください。  
  
|パラメータ名|説明|デフォルト値|
----|----|---- 
|pgname|プログラム名をメッセージに表示します|社畜VCS|
|version|プログラム名を画面に表示します|社畜VCS for WinSCP|
|capt_lblHistory|ラベル名です|履歴一覧|
|capt_txtFindComment|ラベル名です|コメント検索|
|capt_btnClear|ボタン名です|クリア|
|capt_btnFind|ボタン名です|検索|
|capt_ttlDT|ラベル名です|日時|
|capt_ttlUsrName|ラベル名です|利用者|
|capt_ttlRevisionID|ラベル名です|リビジョンID|
|capt_ttlFileName|ラベル名です|ファイル名|
|capt_ttlRemoteDirectory|ラベル名です|リモートディレクトリ|
|capt_ttlLocalPath|ラベル名です|ローカルパス|
|capt_ttlComment|ラベル名です|コメント|
|capt_ttlRevertFlag|未使用|リバートFLG|
|capt_lblRevID|未使用|リビジョンID|
|capt_lblRmtPath|未使用|リモートパス|
|capt_lblComment|ラベル名です|コメント|
|capt_lblCmtComment|ラベル名です|コメントを入力してください|
|capt_btnCheckRcnt|ボタン名です|リモートファイルと比較|
|capt_btnCheckSel|ボタン名です|前回リビジョンとの差分を表示|
|capt_btnRevert|ボタン名です|リバート|
|capt_btnExport|ボタン名です|エクスポート|
|capt_btnComment|ボタン名です|コメント編集|
|capt_btnUpdate|ボタン名です|コメント更新|
|capt_btnCommit|ボタン名です|コミット|
|capt_btnCan|ボタン名です|閉じる|
|capt_btnCcl|ボタン名です|編集キャンセル|
|capt_msgCfm|メッセージ内容です|本当によろしいですか？|
|capt_msgReboot|メッセージ内容です|初期設定が完了しました。|
|history|履歴ファイルのディレクトリパスが入ります|C:\Users\（ユーザ名）\.shchk\ShckHistory.xml|
|work_dir|リポジトリを保存するディレクトリパスが入ります|C:\Users\（ユーザ名）\.shchk\|
